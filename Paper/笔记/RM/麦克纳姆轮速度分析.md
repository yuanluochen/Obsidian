# 麦克纳姆轮速度分析

[工程底盘麦克纳姆轮示意图及其运动分析](:/93664deb31a94a8ca8d2cc6f925513ce)

![工程底盘麦克纳姆轮示意图](../../resources/Pasted%20image%2020220829215846.png)

| 底盘速度    | 麦克纳姆轮速度                       |
| ----------- | ------------------------------------ |
| 前进速度 Vx | V1 = Vx, V2 = Vx, V3 = Vx, V4 = Vx   |
| 左移速度 Vy | V1 = Vy, V2 = -Vy, V3 = -Vy, V4 = Vy |
| 旋转速度 Wz | V1 = Wz，V2 = -Wz, V3= Wz, V4 = -Wz  |

如下图所示

![运动示意图](../../resources/Pasted%20image%2020220830163459.png)

底盘四个麦克纳姆轮的速度要通过PID控制电机电流使四个电机速度保持相同，若速度不同分速度无法抵消，会使底盘发生转弯。大疆官方代码底盘跟随云台转动。底盘想要转动需要让云台转动，所以工程要去掉云台控制，才可使转动。

所以由上表公式可得出每个麦克纳姆轮的速度公式

$$
V1 = Vx + Vy + Wz 
$$
$$
V2 = Vx - Vy - Wz
$$
$$
V3 = Vx - Vy + Wz
$$
$$
V4 = Vx + Vy - Wz
$$

由于电机1和电机3处于前进速度时，电机1和电机3是顺时针旋转，其速度为负值，电机2和电机是逆时针旋转为正值，所以公式需要进行修正，修正后的公式为

$$
V1 = -Vx - Vy - Wz 
$$
$$
V2 = Vx - Vy - Wz
$$
$$
V3 = -Vx + Vy - Wz
$$
$$
V4 = Vx + Vy - Wz
$$

由于云台安装位置不在底盘中心，往往是在底盘前部，故在旋转时，电机1和电机2需要较慢的速度，电机3和电机4需要较快的速度，所以需要进行修正。假定a为修正因子，修正公式如下。

$$
V1 = -Vx - Vy + (a - 1)Wz 
$$
$$
V2 = Vx - Vy + (a - 1)Wz
$$
$$
V3 = -Vx + Vy + (a - 1)Wz
$$
$$
V4 = Vx + Vy + (a - 1)Wz
$$



$$

$$